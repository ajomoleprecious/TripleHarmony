let StickStatus={xPosition:0,yPosition:0,x:0,y:0,cardinalDirection:"C"};var JoyStick=function(t,e,i){var o=void 0===(e=e||{}).title?"joystick":e.title,n=void 0===e.width?0:e.width,a=void 0===e.height?0:e.height,r=void 0===e.internalFillColor?"#00AA00":e.internalFillColor,c=void 0===e.internalLineWidth?2:e.internalLineWidth,s=void 0===e.internalStrokeColor?"#003300":e.internalStrokeColor,d=void 0===e.externalLineWidth?2:e.externalLineWidth,u=(void 0===e.externalStrokeColor||e.externalStrokeColor,void 0===e.autoReturnToCenter||e.autoReturnToCenter);i=i||function(t){};var $=document.getElementById(t);$.style.touchAction="none";var h=document.createElement("canvas");h.id=o,0===n&&(n=$.clientWidth),0===a&&(a=$.clientHeight),h.width=n,h.height=a,$.appendChild(h);var S=h.getContext("2d"),l=0,f=2*Math.PI,k=(h.width-(h.width/2+10))/2,_=k+5,g=k+30,x=h.width/2,v=h.height/2,P=h.width/10,C=-1*P,p=h.height/10,y=-1*p,w=x,L=v;function F(){S.beginPath(),S.arc(x,v,g,0,f,!1),S.lineWidth=d,S.strokeStyle="red",S.stroke()}function m(){S.beginPath(),w<k&&(w=_),w+k>h.width&&(w=h.width-_),L<k&&(L=_),L+k>h.height&&(L=h.height-_),S.arc(w,L,k,0,f,!1);var t=S.createRadialGradient(x,v,5,x,v,200);t.addColorStop(0,r),t.addColorStop(1,s),S.fillStyle="black",S.fill(),S.lineWidth=c,S.strokeStyle="black",S.stroke()}"ontouchstart"in document.documentElement?(h.addEventListener("touchstart",function t(e){l=1,E=e.targetTouches[0].identifier},!1),document.addEventListener("touchmove",function t(e){1===l&&e.targetTouches[0].target===h&&(w=e.targetTouches[0].pageX,L=e.targetTouches[0].pageY,"BODY"===h.offsetParent.tagName.toUpperCase()?(w-=h.offsetLeft,L-=h.offsetTop):(w-=h.offsetParent.offsetLeft,L-=h.offsetParent.offsetTop),S.clearRect(0,0,h.width,h.height),F(),m(),StickStatus.xPosition=w,StickStatus.yPosition=L,StickStatus.x=(100*((w-x)/_)).toFixed(),StickStatus.y=(-(100*((L-v)/_)*1)).toFixed(),StickStatus.cardinalDirection=W(),i(StickStatus))},!1),document.addEventListener("touchend",function t(e){e.changedTouches[0].identifier===E&&(l=0,u&&(w=x,L=v),S.clearRect(0,0,h.width,h.height),F(),m(),StickStatus.xPosition=w,StickStatus.yPosition=L,StickStatus.x=(100*((w-x)/_)).toFixed(),StickStatus.y=(-(100*((L-v)/_)*1)).toFixed(),StickStatus.cardinalDirection=W(),i(StickStatus))},!1)):(h.addEventListener("mousedown",T,!1),document.addEventListener("mousemove",function t(e){1===l&&(w=e.pageX,L=e.pageY,"BODY"===h.offsetParent.tagName.toUpperCase()?(w-=h.offsetLeft,L-=h.offsetTop):(w-=h.offsetParent.offsetLeft,L-=h.offsetParent.offsetTop),S.clearRect(0,0,h.width,h.height),F(),m(),StickStatus.xPosition=w,StickStatus.yPosition=L,StickStatus.x=(100*((w-x)/_)).toFixed(),StickStatus.y=(-(100*((L-v)/_)*1)).toFixed(),StickStatus.cardinalDirection=W(),i(StickStatus))},!1),document.addEventListener("mouseup",function t(e){l=0,u&&(w=x,L=v),S.clearRect(0,0,h.width,h.height),F(),m(),StickStatus.xPosition=w,StickStatus.yPosition=L,StickStatus.x=(100*((w-x)/_)).toFixed(),StickStatus.y=(-(100*((L-v)/_)*1)).toFixed(),StickStatus.cardinalDirection=W(),i(StickStatus)},!1)),F(),m();let E=null;function T(t){l=1}function W(){let t="",e=w-x,i=L-v;return i>=y&&i<=p&&(t="C"),i<y&&(t="N"),i>p&&(t="S"),e<C&&("C"===t?t="W":t+="W"),e>P&&("C"===t?t="E":t+="E"),t}this.GetWidth=function(){return h.width},this.GetHeight=function(){return h.height},this.GetPosX=function(){return w},this.GetPosY=function(){return L},this.GetX=function(){return(100*((w-x)/_)).toFixed()},this.GetY=function(){return(-(100*((L-v)/_)*1)).toFixed()},this.GetDir=function(){return W()}};